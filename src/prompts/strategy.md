# Remediation Strategy Prompt

You are planning WCAG 2.1 AA accessibility remediation for a university course document. Based on the comprehension analysis, create a specific remediation plan.

## Your Task

Create an ordered list of remediation actions. Each action must specify:
- **element_id**: Which element to fix (e.g., "img_0", "p_3", "tbl_0")
- **action_type**: What to do (see available actions below)
- **parameters**: Specific values for the action
- **rationale**: Why this fix is needed (cite the WCAG criterion)

## Available Actions

| action_type | parameters | WCAG |
|-------------|-----------|------|
| `set_alt_text` | `{"paragraph_index": int, "drawing_index": int, "alt_text": "..."}` | 1.1.1 |
| `set_decorative` | `{"paragraph_index": int, "drawing_index": int}` | 1.1.1 |
| `set_heading_level` | `{"paragraph_index": int, "level": int}` | 1.3.1, 2.4.6 |
| `mark_header_rows` | `{"table_index": int, "header_count": int}` | 1.3.1 |
| `set_title` | `{"title": "..."}` | 2.4.2 |
| `set_language` | `{"language": "..."}` | 3.1.1 |
| `set_link_text` | `{"new_text": "descriptive text"}` | 2.4.4 |
| `fix_all_contrast` | `{"default_bg": "#FFFFFF"}` | 1.4.3 |

## Image Alt Text — CRITICAL

The comprehension analysis includes an `image_descriptions` field containing **detailed, vision-analyzed descriptions** of each image generated by a multimodal AI that actually viewed the images. You CANNOT see the images yourself.

**You MUST create a `set_alt_text` action for EVERY image that has an entry in `image_descriptions`.** This includes images that already have alt text — existing alt text is often auto-generated garbage (e.g., "A close up of text on a white background") and must be replaced.

**Use the FULL description from `image_descriptions` as the alt text.** Do NOT shorten, summarize, or truncate it. A blind student must be able to understand the image as completely as a sighted student.

If an image is decorative (logos, dividers, backgrounds), use `set_decorative` instead.

**IMPORTANT: `drawing_index` for images in .docx documents.** Each image in the document summary includes a `drawing_index` field that indicates which drawing element it corresponds to within its paragraph. You MUST include this value in the parameters for `set_alt_text` and `set_decorative` actions. Without the correct `drawing_index`, images in multi-image paragraphs will get the wrong alt text. If `drawing_index` is not shown in the image data, use `0`.

## Contrast Fixing

If the validation report shows contrast failures (criterion 1.4.3), add a single `fix_all_contrast` action. This will automatically scan and fix every low-contrast text run in the document by darkening the foreground color. You do NOT need to create individual actions for each contrast issue — `fix_all_contrast` handles them all in one pass.

## Link Text — WCAG 2.4.4

The document summary includes a `links` section listing all hyperlinks found. For any link where the display text is a raw URL (e.g., "http://www.plagiarism.org/article/what-is-"), create a `set_link_text` action with descriptive text that conveys the link's purpose. Use the URL path, surrounding paragraph context, and common sense to generate clear, concise link text.

**Examples:**
- `http://www.plagiarism.org/article/what-is-` → "What Is Plagiarism? (Plagiarism.org)"
- `https://ovpi.uga.edu/academic-honesty/` → "UGA Academic Honesty Policy"
- `http://catalog.uga.edu/content.php?catoid=21&navoid=3035` → "UGA Course Catalog"
- `mailto:student@uga.edu` → skip (mailto links are self-descriptive)

Do NOT create `set_link_text` for links that already have descriptive text (non-URL text). Only fix links where the visible text IS the URL.

## Metadata — Title and Language

The comprehension analysis includes `suggested_title` and `suggested_language` fields from the multimodal AI's analysis. **Always create `set_title` and `set_language` actions** using these values (or reasonable defaults):
- If `suggested_title` is non-empty, use it for `set_title`
- If `suggested_language` is non-empty, use it for `set_language`
- If `suggested_language` is empty, default to `"en"` for English-language documents

## Ordering Rules

1. **Metadata first** (title, language) — these are quick wins
2. **Contrast fix** (fix_all_contrast) — bulk fix, run early
3. **Link text** (set_link_text) — fix raw URL links
4. **Structure next** (headings, table headers) — these affect navigation
5. **Content last** (alt text) — these are the most work
6. If unsure about an element, add it to `items_for_human_review`

## Comprehension Analysis

```json
{comprehension_json}
```

## Document Structure

```json
{document_json}
```

## Pre-Remediation Validation

{validation_report}
